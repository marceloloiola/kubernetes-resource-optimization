# Auditoria de Recursos - Cluster Kubernetes
# Data: 31 de Janeiro de 2026
# Cluster: RKE2 Production (3 n√≥s)
# Gerado por: check_slack_percent.sh

================================================================================
RESUMO EXECUTIVO
================================================================================

Cluster: RKE2 Production
Nodes: 3 (sr-atilxapp0137, sr-atilxapp0138, sr-atilxapp0139)
CPU Total Dispon√≠vel: 24 cores (8 por node)
CPU Total Solicitada: 13.535m (~13.5 cores)
CPU Total Utilizada: 1.535m (~1.5 cores)

Efici√™ncia Global: 11.4%
Desperd√≠cio Global: 88.6%
Status: üî¥ CR√çTICO

================================================================================
DETALHAMENTO POR NAMESPACE
================================================================================

NAMESPACE                           REQUESTED       USED            SLACK (m)       WASTE %
---------------------------------------------------------------------------------------------------
kube-system                         3925m           625m            3300m           84.1%
istio-system                        1410m           21m             1389m           98.5%
longhorn-system                     1200m           211m            989m            82.4%
esusaf-hml                          580m            114m            466m            80.3%
sers-fiscal-hml                     300m            6m              294m            98.0%
painel-frotas-hml                   250m            6m              244m            97.6%
sers-checklist-hml                  230m            6m              224m            97.4%
nanf-hml                            230m            6m              224m            97.4%
nanf-analise-hml                    230m            6m              224m            97.4%
credor-hml                          230m            6m              224m            97.4%
painel-mobiliario-dev               120m            3m              117m            97.5%
painel-emendas-federais-dev         120m            3m              117m            97.5%
painel-emendas-estaduais-dev        120m            3m              117m            97.5%
cattle-monitoring-system            950m            111m            839m            88.3%
velero                              560m            6m              554m            98.9%
sers-fiscal-dev                     270m            6m              264m            97.8%
painel-frotas-dev                   120m            3m              117m            97.5%
nanf-dev                            230m            6m              224m            97.4%
nanf-analise-dev                    230m            6m              224m            97.4%
credor-dev                          230m            6m              224m            97.4%
sers-checklist-dev                  330m            9m              321m            97.3%
istio-ingress                       100m            4m              96m             96.0%
analytics                           850m            50m             800m            94.1%
esusaf-dev                          330m            106m            224m            67.9%
painel-mobiliario-hml               250m            6m              244m            97.6%
painel-emendas-federais-hml         125m            3m              122m            97.6%
painel-emendas-estaduais-hml        125m            3m              122m            97.6%

================================================================================
AN√ÅLISE POR CRITICIDADE
================================================================================

üî¥ CR√çTICO (Desperd√≠cio > 95%):
---------------------------------------------------------------------------------------------------
velero                              560m            6m              554m            98.9%
istio-system                        1410m           21m             1389m           98.5%
sers-fiscal-hml                     300m            6m              294m            98.0%
sers-fiscal-dev                     270m            6m              264m            97.8%
painel-frotas-hml                   250m            6m              244m            97.6%
painel-mobiliario-hml               250m            6m              244m            97.6%
painel-emendas-federais-hml         125m            3m              122m            97.6%
painel-emendas-estaduais-hml        125m            3m              122m            97.6%
painel-mobiliario-dev               120m            3m              117m            97.5%
painel-emendas-federais-dev         120m            3m              117m            97.5%
painel-emendas-estaduais-dev        120m            3m              117m            97.5%
sers-checklist-hml                  230m            6m              224m            97.4%
nanf-hml                            230m            6m              224m            97.4%
nanf-analise-hml                    230m            6m              224m            97.4%
credor-hml                          230m            6m              224m            97.4%
nanf-dev                            230m            6m              224m            97.4%
nanf-analise-dev                    230m            6m              224m            97.4%
credor-dev                          230m            6m              224m            97.4%
sers-checklist-dev                  330m            9m              321m            97.3%
istio-ingress                       100m            4m              96m             96.0%

SUBTOTAL CR√çTICO: 6.930m solicitados | 264m usados | 6.666m desperdi√ßados

üü° ALTO (Desperd√≠cio 80-95%):
---------------------------------------------------------------------------------------------------
analytics                           850m            50m             800m            94.1%
cattle-monitoring-system            950m            111m            839m            88.3%
kube-system                         3925m           625m            3300m           84.1%
longhorn-system                     1200m           211m            989m            82.4%
esusaf-hml                          580m            114m            466m            80.3%

SUBTOTAL ALTO: 7.505m solicitados | 1.111m usados | 6.394m desperdi√ßados

üü¢ MODERADO (Desperd√≠cio < 80%):
---------------------------------------------------------------------------------------------------
esusaf-dev                          330m            106m            224m            67.9%

SUBTOTAL MODERADO: 330m solicitados | 106m usados | 224m desperdi√ßados

================================================================================
TOP 10 DESPERDI√áADORES (SLACK ABSOLUTO)
================================================================================

1. kube-system                      3925m ‚Üí 625m    (3300m desperdi√ßados)
2. istio-system                     1410m ‚Üí 21m     (1389m desperdi√ßados)
3. longhorn-system                  1200m ‚Üí 211m    (989m desperdi√ßados)
4. cattle-monitoring-system         950m  ‚Üí 111m    (839m desperdi√ßados)
5. analytics                        850m  ‚Üí 50m     (800m desperdi√ßados)
6. velero                           560m  ‚Üí 6m      (554m desperdi√ßados)
7. esusaf-hml                       580m  ‚Üí 114m    (466m desperdi√ßados)
8. sers-checklist-dev               330m  ‚Üí 9m      (321m desperdi√ßados)
9. sers-fiscal-hml                  300m  ‚Üí 6m      (294m desperdi√ßados)
10. sers-fiscal-dev                 270m  ‚Üí 6m      (264m desperdi√ßados)

TOTAL TOP 10: 10.375m solicitados | 1.153m usados | 9.222m desperdi√ßados (89% do total)

================================================================================
POTENCIAL DE ECONOMIA
================================================================================

Cen√°rio CONSERVADOR (reduzir desperd√≠cio para 50%):
  Economia: ~6.000m (~6 CPUs)
  Novos requests: ~7.500m
  Nova efici√™ncia: ~20%

Cen√°rio MODERADO (reduzir desperd√≠cio para 30%):
  Economia: ~8.000m (~8 CPUs)
  Novos requests: ~5.500m
  Nova efici√™ncia: ~28%

Cen√°rio AGRESSIVO (reduzir desperd√≠cio para 15%):
  Economia: ~9.800m (~10 CPUs)
  Novos requests: ~3.700m
  Nova efici√™ncia: ~42%

================================================================================
RECOMENDA√á√ïES IMEDIATAS
================================================================================

PRIORIDADE 1 (Esta Semana):
‚úì velero (98.9% desperd√≠cio) - CONCLU√çDO ‚úÖ
  ‚îî‚îÄ Economia: 515m

‚ñ° istio-system (98.5% desperd√≠cio)
  ‚îî‚îÄ Potencial: ~1.350m

‚ñ° Pain√©is HML/DEV (>97% desperd√≠cio)
  ‚îî‚îÄ Potencial: ~1.800m combinados

PRIORIDADE 2 (Pr√≥ximas 2 Semanas):
‚ñ° cattle-monitoring-system (88.3% desperd√≠cio)
  ‚îî‚îÄ Potencial: ~750m

‚ñ° analytics (94.1% desperd√≠cio)
  ‚îî‚îÄ Potencial: ~750m

‚ñ° longhorn-system (82.4% desperd√≠cio)
  ‚îî‚îÄ Potencial: ~900m

PRIORIDADE 3 (Pr√≥ximo M√™s):
‚ñ° kube-system (84.1% desperd√≠cio)
  ‚îî‚îÄ Potencial: ~2.500m (CUIDADO: componentes cr√≠ticos)

================================================================================
OBSERVA√á√ïES T√âCNICAS
================================================================================

1. Sidecars Istio:
   - Detectado uso excessivo de proxies (100m default)
   - Recomenda√ß√£o: Reduzir para 10-20m em ambientes n√£o-prod

2. Aplica√ß√µes de Pain√©is:
   - Padr√£o comum: 120-250m solicitados, 3-6m usados
   - Recomenda√ß√£o: Padronizar em 10-15m para dev/hml

3. Longhorn:
   - Instance managers com 400m cada
   - Uso real: ~30-40m
   - Recomenda√ß√£o: Reduzir para 50m

4. Kube-system:
   - Componentes cr√≠ticos, abordar com cautela
   - Focar em: coredns, ingress-controller
   - Evitar: apiserver, etcd, scheduler

5. Ambientes Dev vs Hml:
   - Desperd√≠cio similar em ambos
   - Oportunidade de padroniza√ß√£o

================================================================================
M√âTRICAS DE PROGRESSO
================================================================================

Status Atual (31/01/2026):
‚îú‚îÄ Namespaces Auditados: 27
‚îú‚îÄ Namespaces Otimizados: 1 (velero) ‚úÖ
‚îú‚îÄ Economia Realizada: 515m (3.8% do desperd√≠cio total)
‚îú‚îÄ Economia Potencial Restante: ~12.500m
‚îî‚îÄ Pr√≥ximo Alvo: istio-system

Meta para Q1 2026:
‚îú‚îÄ Otimizar top 10 namespaces
‚îú‚îÄ Atingir efici√™ncia de 40%
‚îú‚îÄ Liberar ~8 CPUs para novas cargas
‚îî‚îÄ Estabelecer processo cont√≠nuo de auditoria

================================================================================
FIM DO RELAT√ìRIO
================================================================================

Gerado por: check_slack_percent.sh v2.0
Autor: Marcelo Loiola
Data: 2026-01-31 14:30:00 BRT
Cluster: RKE2 Production (3 n√≥s)
